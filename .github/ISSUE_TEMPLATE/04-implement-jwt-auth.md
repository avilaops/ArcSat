---
name: Backend - Implement JWT Authentication
about: Sistema completo de autentica√ß√£o com JWT
title: 'üîê Feature: Implementar autentica√ß√£o JWT'
labels: 'backend, authentication, security'
assignees: ''
---

## üéØ Objetivo

Implementar sistema completo de autentica√ß√£o JWT com:
- Registro de usu√°rios
- Login com email/senha
- Refresh tokens
- Middleware de autentica√ß√£o

## üìã Tarefas

### 1. Criar Middleware de Autentica√ß√£o

**Arquivo:** `src/middleware/auth.ts`

```typescript
export const authenticate = async (req: AuthRequest, res: Response, next: NextFunction) => {
  // Verificar token no header Authorization
  // Validar token JWT
  // Adicionar user ao req
  // Chamar next() ou retornar 401
}
```

### 2. Criar Rotas de Autentica√ß√£o

**Arquivo:** `src/routes/auth.ts`

**Endpoints:**

#### POST `/auth/register`
```typescript
{
  name: string;
  email: string;
  password: string;
}
```

#### POST `/auth/login`
```typescript
{
  email: string;
  password: string;
}
// Retorna: { accessToken, refreshToken, user }
```

#### POST `/auth/refresh`
```typescript
{
  refreshToken: string;
}
// Retorna: { accessToken }
```

#### POST `/auth/logout`
```typescript
// Invalidar refresh token
```

#### GET `/auth/me`
```typescript
// Retorna dados do usu√°rio autenticado
```

### 3. Configura√ß√£o JWT

**Arquivo:** `src/config/env.ts`

```typescript
JWT_SECRET: process.env.JWT_SECRET,
JWT_EXPIRES_IN: process.env.JWT_EXPIRES_IN || '15m',
JWT_REFRESH_SECRET: process.env.JWT_REFRESH_SECRET,
JWT_REFRESH_EXPIRES_IN: process.env.JWT_REFRESH_EXPIRES_IN || '7d',
```

### 4. Valida√ß√£o com Zod

```typescript
const registerSchema = z.object({
  name: z.string().min(3),
  email: z.string().email(),
  password: z.string().min(8).regex(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/)
});
```

## üìÅ Arquivos a Criar

- `src/middleware/auth.ts`
- `src/routes/auth.ts`
- `src/controllers/auth.controller.ts`
- `src/utils/jwt.ts`

## ‚úÖ Crit√©rio de Aceita√ß√£o

- [ ] Endpoint `/auth/register` funcionando
- [ ] Endpoint `/auth/login` funcionando
- [ ] Endpoint `/auth/refresh` funcionando
- [ ] Endpoint `/auth/logout` funcionando
- [ ] Endpoint `/auth/me` funcionando
- [ ] Middleware `authenticate` protegendo rotas
- [ ] Valida√ß√£o Zod em todos os endpoints
- [ ] Senhas hasheadas com bcrypt
- [ ] Tokens JWT com expira√ß√£o
- [ ] Refresh tokens persistidos
- [ ] Rate limiting (10 req/min no login)
- [ ] TypeScript sem erros
- [ ] Testes unit√°rios

## üîí Seguran√ßa

- [ ] Senhas NUNCA retornadas nas respostas
- [ ] Tokens assinados com secret forte
- [ ] Rate limiting implementado
- [ ] CORS configurado corretamente
- [ ] Helmet habilitado

## üîó Refer√™ncias

- [JWT Best Practices](https://auth0.com/blog/a-look-at-the-latest-draft-for-jwt-bcp/)
- [jsonwebtoken npm](https://www.npmjs.com/package/jsonwebtoken)
- [Zod](https://zod.dev/)

## ‚è±Ô∏è Prioridade

**HIGH** - Necess√°rio para qualquer funcionalidade protegida.
