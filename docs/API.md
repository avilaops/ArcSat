# 游닀 Documenta칞칚o da API - ArcSat CRM

Base URL: `http://localhost:5500/api/v1`

## 游닄 칈ndice

- [Autentica칞칚o](#autentica칞칚o)
- [Usu치rios](#usu치rios)
- [Empresas](#empresas)
- [CNPJ](#cnpj)
- [C칩digos de Status](#c칩digos-de-status)
- [Exemplos](#exemplos)

## 游댏 Autentica칞칚o

Todas as rotas protegidas requerem um token JWT no header:

```
Authorization: Bearer {token}
```

### POST /auth/register

Registrar novo usu치rio.

**Request:**
```json
{
  "name": "Jo칚o Silva",
  "email": "joao@example.com",
  "password": "senha123",
  "company": "64f5b3c2e4b0a1234567890"
}
```

**Response: 201 Created**
```json
{
  "status": "success",
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "user": {
    "id": "64f5b3c2e4b0a1234567891",
    "name": "Jo칚o Silva",
    "email": "joao@example.com",
    "role": "user"
  }
}
```

### POST /auth/login

Login de usu치rio.

**Request:**
```json
{
  "email": "joao@example.com",
  "password": "senha123"
}
```

**Response: 200 OK**
```json
{
  "status": "success",
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "user": {
    "id": "64f5b3c2e4b0a1234567891",
    "name": "Jo칚o Silva",
    "email": "joao@example.com",
    "role": "user"
  }
}
```

**Erros:**
- `401` - Email ou senha incorretos
- `400` - Dados inv치lidos

## 游논 Usu치rios

### GET /users

Listar todos os usu치rios (Admin only).

**Headers:**
```
Authorization: Bearer {token}
```

**Response: 200 OK**
```json
{
  "status": "success",
  "count": 2,
  "data": [
    {
      "id": "64f5b3c2e4b0a1234567891",
      "name": "Jo칚o Silva",
      "email": "joao@example.com",
      "role": "user",
      "company": {
        "id": "64f5b3c2e4b0a1234567890",
        "name": "Empresa XYZ"
      },
      "createdAt": "2025-01-15T10:30:00.000Z"
    }
  ]
}
```

### GET /users/:id

Buscar usu치rio por ID.

**Response: 200 OK**
```json
{
  "status": "success",
  "data": {
    "id": "64f5b3c2e4b0a1234567891",
    "name": "Jo칚o Silva",
    "email": "joao@example.com",
    "role": "user",
    "company": {
      "id": "64f5b3c2e4b0a1234567890",
      "name": "Empresa XYZ"
    },
    "createdAt": "2025-01-15T10:30:00.000Z",
    "lastLogin": "2025-01-20T15:45:00.000Z"
  }
}
```

### PUT /users/:id

Atualizar usu치rio.

**Request:**
```json
{
  "name": "Jo칚o Silva Jr.",
  "email": "joao.jr@example.com"
}
```

**Response: 200 OK**
```json
{
  "status": "success",
  "data": {
    "id": "64f5b3c2e4b0a1234567891",
    "name": "Jo칚o Silva Jr.",
    "email": "joao.jr@example.com",
    "role": "user"
  }
}
```

### DELETE /users/:id

Deletar usu치rio (Admin only).

**Response: 204 No Content**

## 游끽 Empresas

### POST /companies

Criar nova empresa.

**Request:**
```json
{
  "name": "Empresa XYZ Ltda",
  "cnpj": "12.345.678/0001-99",
  "category": "cliente",
  "address": {
    "street": "Rua das Flores",
    "number": "123",
    "neighborhood": "Centro",
    "city": "S칚o Paulo",
    "state": "SP",
    "zipCode": "01234-567"
  },
  "contacts": [
    {
      "name": "Maria Santos",
      "role": "Gerente",
      "phone": "(11) 98765-4321",
      "email": "maria@empresa.com"
    }
  ]
}
```

**Response: 201 Created**
```json
{
  "status": "success",
  "data": {
    "id": "64f5b3c2e4b0a1234567890",
    "name": "Empresa XYZ Ltda",
    "cnpj": "12.345.678/0001-99",
    "category": "cliente",
    "status": "ativo",
    "createdAt": "2025-01-15T10:30:00.000Z"
  }
}
```

### GET /companies

Listar todas as empresas.

**Query Parameters:**
- `category` - Filtrar por categoria (cliente, fornecedor, parceiro)
- `status` - Filtrar por status (ativo, inativo, prospecto)
- `page` - N칰mero da p치gina (padr칚o: 1)
- `limit` - Items por p치gina (padr칚o: 10)

**Response: 200 OK**
```json
{
  "status": "success",
  "count": 25,
  "page": 1,
  "pages": 3,
  "data": [
    {
      "id": "64f5b3c2e4b0a1234567890",
      "name": "Empresa XYZ Ltda",
      "cnpj": "12.345.678/0001-99",
      "category": "cliente",
      "status": "ativo"
    }
  ]
}
```

### GET /companies/:id

Buscar empresa por ID.

**Response: 200 OK**
```json
{
  "status": "success",
  "data": {
    "id": "64f5b3c2e4b0a1234567890",
    "name": "Empresa XYZ Ltda",
    "cnpj": "12.345.678/0001-99",
    "category": "cliente",
    "status": "ativo",
    "address": {
      "street": "Rua das Flores",
      "number": "123",
      "city": "S칚o Paulo",
      "state": "SP"
    },
    "contacts": [
      {
        "name": "Maria Santos",
        "role": "Gerente",
        "phone": "(11) 98765-4321",
        "email": "maria@empresa.com"
      }
    ],
    "createdAt": "2025-01-15T10:30:00.000Z"
  }
}
```

### PUT /companies/:id

Atualizar empresa.

**Request:**
```json
{
  "status": "inativo",
  "notes": "Contrato encerrado"
}
```

**Response: 200 OK**
```json
{
  "status": "success",
  "data": {
    "id": "64f5b3c2e4b0a1234567890",
    "name": "Empresa XYZ Ltda",
    "status": "inativo",
    "updatedAt": "2025-01-20T15:45:00.000Z"
  }
}
```

### DELETE /companies/:id

Deletar empresa.

**Response: 204 No Content**

## 游댌 CNPJ

### GET /cnpj/:cnpj

Consultar informa칞칫es de CNPJ.

**Par칙metros:**
- `cnpj` - CNPJ com ou sem formata칞칚o

**Response: 200 OK**
```json
{
  "status": "success",
  "data": {
    "cnpj": "12.345.678/0001-99",
    "razaoSocial": "EMPRESA XYZ LTDA",
    "nomeFantasia": "Empresa XYZ",
    "situacao": "ATIVA",
    "dataAbertura": "2020-01-15",
    "endereco": {
      "logradouro": "Rua das Flores",
      "numero": "123",
      "bairro": "Centro",
      "municipio": "S칚o Paulo",
      "uf": "SP",
      "cep": "01234-567"
    },
    "telefone": "(11) 3456-7890",
    "email": "contato@empresa.com",
    "capitalSocial": "100000.00",
    "atividades": [
      {
        "codigo": "6201-5/00",
        "descricao": "Desenvolvimento de programas de computador sob encomenda"
      }
    ]
  }
}
```

**Erros:**
- `404` - CNPJ n칚o encontrado
- `400` - CNPJ inv치lido

## 游늵 C칩digos de Status

| C칩digo | Descri칞칚o |
|--------|-----------|
| 200 | OK - Requisi칞칚o bem-sucedida |
| 201 | Created - Recurso criado com sucesso |
| 204 | No Content - Requisi칞칚o bem-sucedida sem conte칰do |
| 400 | Bad Request - Dados inv치lidos |
| 401 | Unauthorized - N칚o autenticado |
| 403 | Forbidden - Sem permiss칚o |
| 404 | Not Found - Recurso n칚o encontrado |
| 409 | Conflict - Conflito (ex: email j치 existe) |
| 429 | Too Many Requests - Rate limit excedido |
| 500 | Internal Server Error - Erro no servidor |

## 游눠 Exemplos

### JavaScript (Fetch)

```javascript
// Login
const response = await fetch('http://localhost:5500/api/v1/auth/login', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
  },
  body: JSON.stringify({
    email: 'joao@example.com',
    password: 'senha123'
  })
});

const { token, user } = await response.json();

// Usar token em requisi칞칫es
const companiesResponse = await fetch('http://localhost:5500/api/v1/companies', {
  headers: {
    'Authorization': `Bearer ${token}`,
    'Content-Type': 'application/json'
  }
});

const companies = await companiesResponse.json();
```

### cURL

```bash
# Login
curl -X POST http://localhost:5500/api/v1/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"joao@example.com","password":"senha123"}'

# Listar empresas
curl http://localhost:5500/api/v1/companies \
  -H "Authorization: Bearer {token}"

# Consultar CNPJ
curl http://localhost:5500/api/v1/cnpj/12345678000199
```

### Python (Requests)

```python
import requests

# Login
response = requests.post(
    'http://localhost:5500/api/v1/auth/login',
    json={
        'email': 'joao@example.com',
        'password': 'senha123'
    }
)

data = response.json()
token = data['token']

# Listar empresas
response = requests.get(
    'http://localhost:5500/api/v1/companies',
    headers={'Authorization': f'Bearer {token}'}
)

companies = response.json()
```

## 游닇 Notas

- Todos os timestamps est칚o em formato ISO 8601
- Pagina칞칚o padr칚o: 10 items por p치gina
- Rate limit: 100 requisi칞칫es por 15 minutos
- Token JWT expira em 24 horas

---

**Documenta칞칚o gerada em:** 2025-10-27
**Vers칚o da API:** v1.0.0
